{"version":3,"sources":["VideoComponent.js","index.js"],"names":["VideoComponent","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","identity","roomName","roomNameErr","previewTracks","localMediaAvailable","hasJoinedRoom","activeRoom","joinRoom","bind","assertThisInitialized","handleRoomNameChange","roomJoined","leaveRoom","detachTracks","detachParticipantTracks","e","target","value","setState","trim","console","log","connectOptions","name","tracks","Video","connect","token","then","error","alert","message","container","forEach","track","appendChild","attach","participant","Array","from","values","attachTracks","detach","detachedElement","remove","room","_this2","previewContainer","refs","localMedia","querySelector","attachParticipantTracks","localParticipant","participants","remoteMedia","on","kind","stop","_this3","axios","get","results","_results$data","data","disconnect","showLocalTrack","react_default","a","createElement","className","ref","joinOrLeaveRoomButton","RaisedButton_default","label","secondary","onClick","primary","Card","TextField_default","hintText","onChange","errorText","undefined","id","Component","dom","document","getElementById","render","MuiThemeProvider_default","muiTheme","getMuiTheme","lightBaseTheme","AppBar_default","title","VideoComponent_VideoComponent"],"mappings":"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","file":"static/js/main.a83a8d0c.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport Video from 'twilio-video';\nimport axios from 'axios';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport TextField from 'material-ui/TextField';\nimport { Card, CardHeader, CardText } from 'material-ui/Card';\n\nexport default class VideoComponent extends Component {\n\tconstructor(props) {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tidentity: null,\n\t\t\troomName: '',\n\t\t\troomNameErr: false, // Track error for room name TextField\n\t\t\tpreviewTracks: null,\n\t\t\tlocalMediaAvailable: false,\n\t\t\thasJoinedRoom: false,\n\t\t\tactiveRoom: '' // Track the current active room\n\t\t};\n\t\tthis.joinRoom = this.joinRoom.bind(this);\n\t\tthis.handleRoomNameChange = this.handleRoomNameChange.bind(this);\n\t\tthis.roomJoined = this.roomJoined.bind(this);\n\t\tthis.leaveRoom = this.leaveRoom.bind(this);\n\t\tthis.detachTracks = this.detachTracks.bind(this);\n\t\tthis.detachParticipantTracks = this.detachParticipantTracks.bind(this);\n\t}\n\n\thandleRoomNameChange(e) {\n\t\tlet roomName = e.target.value;\n\t\tthis.setState({ roomName });\n\t}\n\n\tjoinRoom() {\n\t\tif (!this.state.roomName.trim()) {\n\t\t\tthis.setState({ roomNameErr: true });\n\t\t\treturn;\n\t\t}\n\n\t\tconsole.log(\"Joining room '\" + this.state.roomName + \"'...\");\n\t\tlet connectOptions = {\n\t\t\tname: this.state.roomName\n\t\t};\n\n\t\tif (this.state.previewTracks) {\n\t\t\tconnectOptions.tracks = this.state.previewTracks;\n\t\t}\n\n\t\t// Join the Room with the token from the server and the\n\t\t// LocalParticipant's Tracks.\n\t\tVideo.connect(this.state.token, connectOptions).then(this.roomJoined, error => {\n\t\t\talert('Could not connect to Twilio: ' + error.message);\n\t\t});\n\t}\n\n\tattachTracks(tracks, container) {\n\t\ttracks.forEach(track => {\n\t\t\tcontainer.appendChild(track.attach());\n\t\t});\n\t}\n\n\t// Attaches a track to a specified DOM container\n\tattachParticipantTracks(participant, container) {\n\t\tvar tracks = Array.from(participant.tracks.values());\n\t\tthis.attachTracks(tracks, container);\n\t}\n\n\tdetachTracks(tracks) {\n\t\ttracks.forEach(track => {\n\t\t\ttrack.detach().forEach(detachedElement => {\n\t\t\t\tdetachedElement.remove();\n\t\t\t});\n\t\t});\n\t}\n\n\tdetachParticipantTracks(participant) {\n\t\tvar tracks = Array.from(participant.tracks.values());\n\t\tthis.detachTracks(tracks);\n\t}\n\n\troomJoined(room) {\n\t\t// Called when a participant joins a room\n\t\tconsole.log(\"Joined as '\" + this.state.identity + \"'\");\n\t\tthis.setState({\n\t\t\tactiveRoom: room,\n\t\t\tlocalMediaAvailable: true,\n\t\t\thasJoinedRoom: true\n\t\t});\n\n\t\t// Attach LocalParticipant's Tracks, if not already attached.\n\t\tvar previewContainer = this.refs.localMedia;\n\t\tif (!previewContainer.querySelector('video')) {\n\t\t\tthis.attachParticipantTracks(room.localParticipant, previewContainer);\n\t\t}\n\n\t\t// Attach the Tracks of the Room's Participants.\n\t\troom.participants.forEach(participant => {\n\t\t\tconsole.log(\"Already in Room: '\" + participant.identity + \"'\");\n\t\t\tvar previewContainer = this.refs.remoteMedia;\n\t\t\tthis.attachParticipantTracks(participant, previewContainer);\n\t\t});\n\n\t\t// When a Participant joins the Room, log the event.\n\t\troom.on('participantConnected', participant => {\n\t\t\tconsole.log(\"Joining: '\" + participant.identity + \"'\");\n\t\t});\n\n\t\t// When a Participant adds a Track, attach it to the DOM.\n\t\troom.on('trackAdded', (track, participant) => {\n\t\t\tconsole.log(participant.identity + ' added track: ' + track.kind);\n\t\t\tvar previewContainer = this.refs.remoteMedia;\n\t\t\tthis.attachTracks([track], previewContainer);\n\t\t});\n\n\t\t// When a Participant removes a Track, detach it from the DOM.\n\t\troom.on('trackRemoved', (track, participant) => {\n\t\t\tthis.log(participant.identity + ' removed track: ' + track.kind);\n\t\t\tthis.detachTracks([track]);\n\t\t});\n\n\t\t// When a Participant leaves the Room, detach its Tracks.\n\t\troom.on('participantDisconnected', participant => {\n\t\t\tconsole.log(\"Participant '\" + participant.identity + \"' left the room\");\n\t\t\tthis.detachParticipantTracks(participant);\n\t\t});\n\n\t\t// Once the LocalParticipant leaves the room, detach the Tracks\n\t\t// of all Participants, including that of the LocalParticipant.\n\t\troom.on('disconnected', () => {\n\t\t\tif (this.state.previewTracks) {\n\t\t\t\tthis.state.previewTracks.forEach(track => {\n\t\t\t\t\ttrack.stop();\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis.detachParticipantTracks(room.localParticipant);\n\t\t\troom.participants.forEach(this.detachParticipantTracks);\n\t\t\tthis.state.activeRoom = null;\n\t\t\tthis.setState({ hasJoinedRoom: false, localMediaAvailable: false });\n\t\t});\n\t}\n\n\tcomponentDidMount() {\n\t\taxios.get('/token').then(results => {\n\t\t\tconst { identity, token } = results.data;\n\t\t\tthis.setState({ identity, token });\n\t\t});\n\t}\n\n\tleaveRoom() {\n\t\tthis.state.activeRoom.disconnect();\n\t\tthis.setState({ hasJoinedRoom: false, localMediaAvailable: false });\n\t}\n\n\trender() {\n\t\t// Only show video track after user has joined a room\n\t\tlet showLocalTrack = this.state.localMediaAvailable ? (\n\t\t\t<div className=\"flex-item\">\n\t\t\t\t<div ref=\"localMedia\" />\n\t\t\t</div>\n\t\t) : (\n\t\t\t''\n\t\t);\n\t\t// Hide 'Join Room' button if user has already joined a room.\n\t\tlet joinOrLeaveRoomButton = this.state.hasJoinedRoom ? (\n\t\t\t<RaisedButton label=\"Leave Room\" secondary={true} onClick={this.leaveRoom} />\n\t\t) : (\n\t\t\t<RaisedButton label=\"Join Room\" primary={true} onClick={this.joinRoom} />\n\t\t);\n\t\treturn (\n\t\t\t<Card>\n\t\t\t\t<CardText>\n\t\t\t\t\t<div className=\"flex-container\">\n\t\t\t\t\t\t{showLocalTrack}\n\t\t\t\t\t\t<div className=\"flex-item\">\n\t\t\t\t\t\t\t<TextField\n\t\t\t\t\t\t\t\thintText=\"Room Name\"\n\t\t\t\t\t\t\t\tonChange={this.handleRoomNameChange}\n\t\t\t\t\t\t\t\terrorText={this.state.roomNameErr ? 'Room Name is required' : undefined}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t{joinOrLeaveRoomButton}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex-item\" ref=\"remoteMedia\" id=\"remote-media\" />\n\t\t\t\t\t</div>\n\t\t\t\t</CardText>\n\t\t\t</Card>\n\t\t);\n\t}\n}\n","// import React from 'react';\n// import ReactDOM from 'react-dom';\n// import './index.css';\n// import App from './App';\n// import * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(<App />, document.getElementById('root'));\n\n// // If you want your app to work offline and load faster, you can change\n// // unregister() to register() below. Note this comes with some pitfalls.\n// // Learn more about service workers: http://bit.ly/CRA-PWA\n// serviceWorker.unregister();\nimport React, { Component } from \"react\";\nimport AppBar from 'material-ui/AppBar';\nimport { render } from \"react-dom\";\nimport \"./App.css\";\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider'\nimport lightBaseTheme from 'material-ui/styles/baseThemes/lightBaseTheme';\nimport getMuiTheme from 'material-ui/styles/getMuiTheme';\n//import injectTapEventPlugin from \"react-tap-event-plugin\";\nimport VideoComponent from './VideoComponent';\n\n//injectTapEventPlugin();\n\nlet dom = document.getElementById(\"app\");\nrender(\n    <MuiThemeProvider muiTheme={getMuiTheme(lightBaseTheme)}>\n        <div>\n            <AppBar title=\"React Twilio Video\" />\n            <VideoComponent />\n        </div>\n    </MuiThemeProvider>\n    ,\n    dom\n);"],"sourceRoot":""}